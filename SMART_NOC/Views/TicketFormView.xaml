<UserControl
    x:Class="SMART_NOC.Views.TicketFormView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:ani="using:CommunityToolkit.WinUI.Animations"
    mc:Ignorable="d"
    Background="#000D15"
    RequestedTheme="Dark">

    <ani:Implicit.ShowAnimations>
        <ani:TranslationAnimation Duration="0:0:0.4" From="0, 20, 0" To="0" />
        <ani:OpacityAnimation Duration="0:0:0.4" From="0" To="1.0"/>
    </ani:Implicit.ShowAnimations>

    <UserControl.Resources>
        <!-- 🔥 MODERN GLASS CARD STYLE 🔥 -->
        <Style x:Key="FormGlassCard" TargetType="Border">
            <Setter Property="Background" Value="#0D1B2A"/>
            <Setter Property="BorderBrush" Value="#1E3A52"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
        </Style>

        <!-- 🔥 DROP ZONE STYLE 🔥 -->
        <Style x:Key="DropZoneStyle" TargetType="Grid">
            <Setter Property="Background" Value="#0D1B2A"/>
            <Setter Property="BorderBrush" Value="#1E3A52"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="12"/>
        </Style>

        <!-- 🔥 EMAIL DROP ZONE 🔥 -->
        <Style x:Key="EmailDropZone" TargetType="Grid" BasedOn="{StaticResource DropZoneStyle}">
            <Setter Property="Background" Value="#0D1B2A"/>
            <Setter Property="BorderBrush" Value="#00B4FF"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <!-- 🔥 IMAGE DROP ZONE 🔥 -->
        <Style x:Key="ImageDropZone" TargetType="Grid" BasedOn="{StaticResource DropZoneStyle}">
            <Setter Property="Background" Value="#0D1B2A"/>
            <Setter Property="BorderBrush" Value="#FF9500"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <!-- 🔥 SECTION HEADER STYLE 🔥 -->
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CharacterSpacing" Value="50"/>
            <Setter Property="FontFamily" Value="{StaticResource InterBold}"/>
            <Setter Property="Opacity" Value="0.95"/>
        </Style>

        <!-- 🔥 SECTION DESCRIPTION STYLE 🔥 -->
        <Style x:Key="SectionDescription" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#E2E8F0"/>
            <Setter Property="Opacity" Value="0.8"/>
            <Setter Property="FontFamily" Value="{StaticResource InterRegular}"/>
        </Style>
    </UserControl.Resources>

    <Grid Padding="32" ColumnSpacing="24">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="340" MinWidth="240"/>
            <ColumnDefinition Width="*" MinWidth="300"/>
            <ColumnDefinition Width="360" MinWidth="240"/>
        </Grid.ColumnDefinitions>

        <!-- 🔥 LEFT PANEL: DATA INGESTION 🔥 -->
        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Padding="0,0,20,0" MinWidth="0">
            <StackPanel Spacing="28">

                <!-- Section Header -->
                <StackPanel Spacing="8">
                    <TextBlock Text="DATA INGESTION" Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="Upload or paste raw incident data" Style="{StaticResource SectionDescription}"/>
                </StackPanel>

                <!-- 🔥 EMAIL DROP ZONE 🔥 -->
                <Grid x:Name="DropZoneArea" 
                      Height="140" 
                      Style="{StaticResource EmailDropZone}"
                      AllowDrop="True" 
                      DragOver="DropZone_DragOver" 
                      Drop="DropZone_Drop">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="14">
                        <FontIcon Glyph="&#xE715;" FontSize="36" Foreground="#00B4FF" HorizontalAlignment="Center"/>
                        <StackPanel HorizontalAlignment="Center" Spacing="4">
                            <TextBlock Text="📧 OUTLOOK EMAIL" 
                                      FontSize="13" 
                                      FontWeight="Bold" 
                                      Foreground="White" 
                                      HorizontalAlignment="Center"
                                      FontFamily="{StaticResource InterBold}"/>
                            <TextBlock Text="Auto-parse .msg file" 
                                      FontSize="11" 
                                      Foreground="#E2E8F0"
                                      HorizontalAlignment="Center"
                                      Opacity="0.8"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <!-- 🔥 IMAGE DROP ZONE 🔥 -->
                <Grid x:Name="DropZoneImage" 
                      Height="140" 
                      Style="{StaticResource ImageDropZone}"
                      AllowDrop="True" 
                      DragOver="DropZoneImage_DragOver" 
                      Drop="DropZoneImage_Drop">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="14">
                        <FontIcon Glyph="&#xE722;" FontSize="36" Foreground="#FF9500" HorizontalAlignment="Center"/>
                        <StackPanel HorizontalAlignment="Center" Spacing="4">
                            <TextBlock x:Name="DropText" 
                                      Text="🖼️ EVIDENCE IMAGE" 
                                      FontSize="13" 
                                      FontWeight="Bold" 
                                      Foreground="White" 
                                      HorizontalAlignment="Center"
                                      FontFamily="{StaticResource InterBold}"/>
                            <TextBlock Text="Extract text &amp; coordinates" 
                                      FontSize="11" 
                                      Foreground="#E2E8F0"
                                      HorizontalAlignment="Center"
                                      Opacity="0.8"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <!-- 🔥 MANUAL INPUT 🔥 -->
                <StackPanel Spacing="10">
                    <TextBlock Text="MANUAL OVERRIDE" 
                              Style="{StaticResource SectionHeader}"/>
                    <TextBox x:Name="TxtRawInput" 
                             AcceptsReturn="True" 
                             TextWrapping="Wrap" 
                             MinHeight="280" 
                             PlaceholderText="Paste raw text here..."
                             TextChanged="TxtRawInput_TextChanged"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             FontFamily="Consolas" 
                             FontSize="11"
                             CornerRadius="10"
                             Background="#0D1B2A"
                             BorderBrush="#1E3A52"
                             BorderThickness="1.5"
                             Foreground="White"
                             Padding="14,10"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- 🔥 CENTER PANEL: TICKET PARAMETERS 🔥 -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" Padding="0,0,20,0" MinWidth="0">
            <StackPanel Spacing="28" Margin="0,0,0,50">

                <!-- Section Header -->
                <StackPanel Spacing="8">
                    <TextBlock Text="TICKET PARAMETERS" Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="Verify and validate all incident data" Style="{StaticResource SectionDescription}"/>
                </StackPanel>

                <!-- 🔥 BASIC INFORMATION CARD 🔥 -->
                <Border Style="{StaticResource FormGlassCard}">
                    <StackPanel Spacing="18">
                        <TextBox x:Name="TxtHeaderTT" 
                                Header="📋 Subject / Header" 
                                PlaceholderText="[MANDAU] LINK DOWN..."
                                TextChanged="Input_TextChanged"
                                Background="#000D15"
                                BorderBrush="#1E3A52"
                                BorderThickness="1.5"
                                CornerRadius="10"
                                Foreground="White"
                                Padding="12,10"/>

                        <Grid ColumnSpacing="14">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="TxtTTIOH" 
                                    Header="🎫 Ticket ID (IOH)" 
                                    PlaceholderText="INC-..."
                                    FontWeight="SemiBold" 
                                    TextChanged="TxtTTIOH_TextChanged"
                                    Background="#000D15"
                                    BorderBrush="#1E3A52"
                                    BorderThickness="1.5"
                                    CornerRadius="10"
                                    Foreground="White"
                                    Padding="12,10"/>

                            <Grid Grid.Column="1" ColumnSpacing="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBox Grid.Column="0" 
                                        x:Name="TxtTTMandau" 
                                        Header="🔧 Ticket ID (Mandau)" 
                                        PlaceholderText="MANDAU-..."
                                        TextChanged="Input_TextChanged"
                                        Background="#000D15"
                                        BorderBrush="#1E3A52"
                                        BorderThickness="1.5"
                                        CornerRadius="10"
                                        Foreground="White"
                                        Padding="12,10"/>

                                <ComboBox Grid.Column="1" 
                                         x:Name="CmbRegion" 
                                         Header="📍 Region" 
                                         HorizontalAlignment="Stretch" 
                                         PlaceholderText="Select..."
                                         SelectionChanged="SegStatus_SelectionChanged"
                                         Background="#000D15"
                                         BorderBrush="#1E3A52"
                                         BorderThickness="1.5"
                                         Foreground="White">
                                    <ComboBoxItem Content="Central Java"/>
                                    <ComboBoxItem Content="West Java"/>
                                    <ComboBoxItem Content="Jabodetabek"/>
                                    <ComboBoxItem Content="Kalimantan"/>
                                    <ComboBoxItem Content="Sumatra South"/>
                                    <ComboBoxItem Content="Sumatra North"/>
                                    <ComboBoxItem Content="East Java"/>
                                    <ComboBoxItem Content="Bali Nusra"/>
                                    <ComboBoxItem Content="Sulawesi"/>
                                    <ComboBoxItem Content="Papua Maluku"/>
                                </ComboBox>
                            </Grid>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- 🔥 TIMING INFORMATION CARD 🔥 -->
                <Border Style="{StaticResource FormGlassCard}">
                    <StackPanel Spacing="18">
                        <Grid ColumnSpacing="14" RowSpacing="14">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBox Grid.Row="0" Grid.Column="0" 
                                    x:Name="TxtOccurTime" 
                                    Header="⏰ Occur Time" 
                                    PlaceholderText="dd/MM/yyyy HH:mm"
                                    TextChanged="Input_TextChanged"
                                    Background="#000D15"
                                    BorderBrush="#1E3A52"
                                    BorderThickness="1.5"
                                    CornerRadius="10"
                                    Foreground="White"
                                    Padding="12,10"/>

                            <TextBox Grid.Row="0" Grid.Column="1" 
                                    x:Name="TxtDispatchTime" 
                                    Header="📤 Dispatch Time" 
                                    PlaceholderText="dd/MM/yyyy HH:mm"
                                    TextChanged="Input_TextChanged"
                                    Background="#000D15"
                                    BorderBrush="#1E3A52"
                                    BorderThickness="1.5"
                                    CornerRadius="10"
                                    Foreground="White"
                                    Padding="12,10"/>

                            <TextBox Grid.Row="1" Grid.Column="0" 
                                    x:Name="TxtClosedTime" 
                                    Header="🔐 Closed Time" 
                                    PlaceholderText="dd/MM/yyyy HH:mm"
                                    TextChanged="Input_TextChanged"
                                    Background="#000D15"
                                    BorderBrush="#1E3A52"
                                    BorderThickness="1.5"
                                    CornerRadius="10"
                                    Foreground="White"
                                    Padding="12,10"/>

                            <AutoSuggestBox Grid.Row="1" Grid.Column="1" 
                                           x:Name="AsbInfoPic" 
                                           Header="👤 PIC / Field Team"
                                           GotFocus="Asb_GotFocus" 
                                           TextChanged="AsbInfoPic_TextChanged" 
                                           SuggestionChosen="AsbInfoPic_SuggestionChosen" 
                                           PlaceholderText="Search technician..."
                                           Background="#000D15"
                                           BorderBrush="#1E3A52"
                                           BorderThickness="1.5"
                                           Foreground="White"/>

                            <AutoSuggestBox Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                                           x:Name="AsbSegmentPM" 
                                           Header="🔗 Target Segment" 
                                           GotFocus="Asb_GotFocus" 
                                           TextChanged="AsbSegmentPM_TextChanged" 
                                           SuggestionChosen="AsbSegmentPM_SuggestionChosen" 
                                           PlaceholderText="Search segment..."
                                           Background="#000D15"
                                           BorderBrush="#1E3A52"
                                           BorderThickness="1.5"
                                           Foreground="White"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- 🔥 LOCATION & ROOT CAUSE CARD 🔥 -->
                <Border Style="{StaticResource FormGlassCard}">
                    <StackPanel Spacing="18">
                        <Grid ColumnSpacing="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="1.3*"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="TxtCutPointDesc" 
                                    Header="📍 Cut Point Description" 
                                    PlaceholderText="Distance / Location..."
                                    TextChanged="Input_TextChanged"
                                    Background="#000D15"
                                    BorderBrush="#1E3A52"
                                    BorderThickness="1.5"
                                    CornerRadius="10"
                                    Foreground="White"
                                    Padding="12,10"/>

                            <Grid Grid.Column="1" ColumnSpacing="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="TxtLatLong" 
                                        Header="🌐 Coordinates" 
                                        PlaceholderText="-6.xxx, 106.xxx"
                                        TextChanged="Input_TextChanged"
                                        Background="#000D15"
                                        BorderBrush="#1E3A52"
                                        BorderThickness="1.5"
                                        CornerRadius="10"
                                        Foreground="White"
                                        Padding="12,10"/>

                                <Button x:Name="BtnViewMap" 
                                       Grid.Column="1" 
                                       Click="BtnViewMap_Click" 
                                       VerticalAlignment="Bottom" 
                                       Margin="0,0,0,4" 
                                       ToolTipService.ToolTip="Open Live Map"
                                       Padding="10,8" 
                                       Style="{StaticResource SubtletyButtonStyle}"
                                       Background="#0D1B2A"
                                       BorderBrush="#1E3A52"
                                       BorderThickness="1.5"
                                       Foreground="White"
                                       CornerRadius="8">
                                    <FontIcon Glyph="&#xE707;" FontSize="16"/>
                                </Button>
                            </Grid>
                        </Grid>

                        <AutoSuggestBox x:Name="TxtRootCause" 
                                       Header="🔍 Root Cause Analysis"
                                       PlaceholderText="Type to search templates..."
                                       TextChanged="TxtRootCause_TextChanged"
                                       SuggestionChosen="TxtRootCause_SuggestionChosen"
                                       Background="#000D15"
                                       BorderBrush="#1E3A52"
                                       BorderThickness="1.5"
                                       Foreground="White"/>
                    </StackPanel>
                </Border>

                <!-- 🔥 STATUS & IMPACT CARD 🔥 -->
                <Border Style="{StaticResource FormGlassCard}">
                    <StackPanel Spacing="18">
                        <!-- Status Section -->
                        <StackPanel Spacing="10">
                            <TextBlock Text="⚡ Current Status" 
                                      Foreground="#E2E8F0" 
                                      FontSize="12" 
                                      FontWeight="SemiBold"
                                      FontFamily="{StaticResource InterBold}"/>
                            <controls:Segmented x:Name="SegStatus" 
                                               SelectionMode="Single" 
                                               SelectionChanged="SegStatus_SelectionChanged" 
                                               HorizontalAlignment="Left"
                                               MinWidth="0"
                                               MaxWidth="340">
                                <controls:SegmentedItem Content="❌ DOWN" Tag="DOWN"/>
                                <controls:SegmentedItem Content="✅ UP" Tag="UP"/>
                                <controls:SegmentedItem Content="⚠️ DEGRADED" Tag="FLAPPING"/>
                                <controls:SegmentedItem Content="⛔ CANCEL" Tag="CANCEL"/>
                            </controls:Segmented>
                        </StackPanel>

                        <MenuFlyoutSeparator Opacity="0.15"/>

                        <!-- Impact Sites Section -->
                        <Grid>
                            <TextBlock Text="📍 Impacted Sites" 
                                      VerticalAlignment="Center" 
                                      FontWeight="SemiBold" 
                                      Foreground="White"
                                      FontFamily="{StaticResource InterBold}"/>
                            <Button x:Name="BtnAddImpact" 
                                   Click="BtnAddImpact_Click" 
                                   HorizontalAlignment="Right" 
                                   Style="{StaticResource SubtletyButtonStyle}"
                                   Background="#0D1B2A"
                                   BorderBrush="#1E3A52"
                                   BorderThickness="1.5"
                                   Foreground="White"
                                   CornerRadius="8"
                                   Padding="10,6">
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <FontIcon Glyph="&#xE710;" FontSize="11"/>
                                    <TextBlock Text="Add Site" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>

                        <ListView x:Name="LvImpacts" 
                                 Height="140" 
                                 CornerRadius="10" 
                                 Background="#000D15"
                                 BorderBrush="#1E3A52"
                                 BorderThickness="1.5">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="90"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBox Text="{Binding Name, Mode=TwoWay}" 
                                                PlaceholderText="Site Name..." 
                                                Margin="0,0,8,0" 
                                                TextChanged="ImpactItem_TextChanged"
                                                CornerRadius="6"
                                                Background="#0D1B2A"
                                                BorderBrush="#1E3A52"
                                                BorderThickness="1.5"
                                                Foreground="White"/>

                                <ComboBox Grid.Column="1" 
                                         SelectedValue="{Binding Status, Mode=TwoWay}" 
                                         SelectedValuePath="Content" 
                                         Margin="0,0,8,0" 
                                         SelectionChanged="ImpactItem_SelectionChanged" 
                                         HorizontalAlignment="Stretch" 
                                         CornerRadius="6"
                                         Background="#0D1B2A"
                                         BorderBrush="#1E3A52"
                                         BorderThickness="1.5"
                                         Foreground="White">
                                    <ComboBoxItem Content="❌"/>
                                    <ComboBoxItem Content="✅"/>
                                </ComboBox>

                                <Button Grid.Column="2" 
                                       Click="BtnDeleteImpact_Click" 
                                       Background="Transparent" 
                                       BorderThickness="0" 
                                       Foreground="#FF3B30" 
                                       Padding="6">
                                    <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                </Button>
                            </Grid>
                        </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- 🔥 CHRONOLOGY/LOGS CARD 🔥 -->
                <Border Style="{StaticResource FormGlassCard}">
                    <Grid>
                        <TextBox x:Name="TxtUpdates" 
                                Header="📝 Chronology / Logs" 
                                AcceptsReturn="True" 
                                TextWrapping="Wrap" 
                                MinHeight="140" 
                                TextChanged="Input_TextChanged"
                                Background="#000D15"
                                BorderBrush="#1E3A52"
                                BorderThickness="1.5"
                                CornerRadius="10"
                                Foreground="White"
                                Padding="12,10"/>

                        <Button x:Name="BtnAutoLog" 
                               Click="BtnAutoLog_Click" 
                               HorizontalAlignment="Right" 
                               VerticalAlignment="Top" 
                               Margin="0,30,0,0" 
                               Style="{StaticResource SubtletyButtonStyle}"
                               Opacity="0.8"
                               Background="#0D1B2A"
                               BorderBrush="#1E3A52"
                               BorderThickness="1.5"
                               Foreground="White"
                               CornerRadius="8"
                               Padding="8,6">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE710;" FontSize="10"/>
                                <TextBlock Text="Auto Log" FontSize="10" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                    </Grid>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- 🔥 RIGHT PANEL: OUTPUT PREVIEW & ACTIONS 🔥 -->
        <Grid Grid.Column="2" RowSpacing="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Section Header -->
            <StackPanel Spacing="8">
                <TextBlock Text="OUTPUT PREVIEW" Style="{StaticResource SectionHeader}"/>
                <TextBlock Text="WhatsApp formatted message" Style="{StaticResource SectionDescription}"/>
            </StackPanel>

            <!-- Preview Box -->
            <Border Grid.Row="1" 
                   Background="#0D1B2A" 
                   BorderBrush="#1E3A52" 
                   BorderThickness="1.5" 
                   CornerRadius="12" 
                   Padding="16"
                   Margin="0,8,0,0">
                <ScrollViewer>
                    <TextBlock x:Name="LblPreview" 
                              TextWrapping="Wrap" 
                              FontFamily="Consolas" 
                              FontSize="11" 
                              Foreground="White" 
                              IsTextSelectionEnabled="True"
                              LineHeight="18"/>
                </ScrollViewer>
            </Border>

            <!-- 🔥 ACTION BUTTONS 🔥 -->
            <StackPanel Grid.Row="2" Spacing="14" Margin="0,0,0,10">
                <!-- Copy/Paste Row -->
                <Grid ColumnSpacing="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button x:Name="BtnCopyForm" 
                           Click="BtnCopyForm_Click" 
                           HorizontalAlignment="Stretch"
                           ToolTipService.ToolTip="Backup data to clipboard"
                           Background="#0D1B2A"
                           BorderBrush="#1E3A52"
                           BorderThickness="1.5"
                           Foreground="White"
                           CornerRadius="10"
                           Padding="14,10"
                           FontSize="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8C8;" FontSize="14"/>
                            <TextBlock Text="Copy Data"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="BtnPasteForm" 
                           Grid.Column="1" 
                           Click="BtnPasteForm_Click" 
                           HorizontalAlignment="Stretch"
                           ToolTipService.ToolTip="Restore from clipboard"
                           Background="#0D1B2A"
                           BorderBrush="#1E3A52"
                           BorderThickness="1.5"
                           Foreground="White"
                           CornerRadius="10"
                           Padding="14,10"
                           FontSize="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE77F;" FontSize="14"/>
                            <TextBlock Text="Paste Data"/>
                        </StackPanel>
                    </Button>
                </Grid>

                <!-- Primary Action Button -->
                <Button x:Name="BtnCopy" 
                       HorizontalAlignment="Stretch" 
                       Height="52" 
                       Click="BtnCopy_Click" 
                       CornerRadius="10"
                       Background="#00B4FF"
                       BorderBrush="#0088CC"
                       BorderThickness="1.5"
                       Foreground="White"
                       FontWeight="Bold"
                       FontSize="13">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <FontIcon Glyph="&#xE8BD;" FontSize="16"/>
                        <TextBlock Text="COPY TO WHATSAPP" FontWeight="Bold" FontFamily="{StaticResource InterBold}"/>
                    </StackPanel>
                </Button>

                <!-- Save & Open Row -->
                <Grid ColumnSpacing="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <Button x:Name="BtnSaveJson" 
                           Grid.Column="0" 
                           HorizontalAlignment="Stretch"
                           Click="BtnSaveJson_Click"
                           Background="#0D1B2A"
                           BorderBrush="#1E3A52"
                           BorderThickness="1.5"
                           Foreground="White"
                           CornerRadius="10"
                           Padding="12,10"
                           FontSize="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74E;" FontSize="14"/>
                            <TextBlock Text="Save"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="BtnOpenData" 
                           Grid.Column="1" 
                           HorizontalAlignment="Stretch" 
                           Click="BtnOpenData_Click"
                           ToolTipService.ToolTip="Open data folder"
                           Background="#0D1B2A"
                           BorderBrush="#1E3A52"
                           BorderThickness="1.5"
                           Foreground="White"
                           CornerRadius="10"
                           Padding="10">
                        <FontIcon Glyph="&#xE8B7;" FontSize="16"/>
                    </Button>
                </Grid>

                <MenuFlyoutSeparator Opacity="0.15" Margin="0,4,0,4"/>

                <!-- Reset Button -->
                <Button x:Name="BtnReset" 
                       HorizontalAlignment="Stretch" 
                       Click="BtnReset_Click"
                       Background="#0D1B2A"
                       BorderBrush="#FFE8E6"
                       BorderThickness="1.5"
                       Foreground="#FF3B30"
                       CornerRadius="10"
                       Padding="12,10"
                       FontSize="12"
                       FontWeight="SemiBold">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                        <TextBlock Text="Reset Form"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>